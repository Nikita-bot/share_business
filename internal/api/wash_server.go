// Code generated by mtgroup-generator.
package api

import (
	"errors"
	"wash-bonus/internal/api/restapi/models"
	washServer "wash-bonus/internal/api/restapi/restapi/operations/wash_server"
	"wash-bonus/internal/app"
	"wash-bonus/internal/def"
	"wash-bonus/internal/dto"
	"wash-bonus/internal/firebase_auth"

	"github.com/go-openapi/runtime/middleware"
	"github.com/go-openapi/swag"

	"wash-bonus/internal/api/restapi/restapi/operations"
)

func setWashServerHandlers(api *operations.WashBonusAPI, svc *service) {
	api.WashServerGetWashServerHandler = washServer.GetWashServerHandlerFunc(svc.GetWashServer)
	api.WashServerAddWashServerHandler = washServer.AddWashServerHandlerFunc(svc.AddWashServer)
	api.WashServerEditWashServerHandler = washServer.EditWashServerHandlerFunc(svc.EditWashServer)
	api.WashServerDeleteWashServerHandler = washServer.DeleteWashServerHandlerFunc(svc.DeleteWashServer)
	api.WashServerListWashServerHandler = washServer.ListWashServerHandlerFunc(svc.ListWashServer)
	api.WashServerGenerateKeyWashServerHandler = washServer.GenerateKeyWashServerHandlerFunc(svc.GenerateKeyWashServer)
}

func (svc *service) GetWashServer(params washServer.GetWashServerParams, profile interface{}) middleware.Responder {
	prof := profile.(*firebase_auth.FirebaseProfile)
	s, err := svc.washServerSvc.Get(dto.ToAppIdentityProfile(*prof), params.ID)
	switch {
	default:
		log.PrintErr("GetWashServer server error", def.LogHTTPStatus, codeInternal.status, "code", codeInternal.extra, "err", err)
		return washServer.NewGetWashServerDefault(codeInternal.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeInternal.extra),
			Message: swag.String("internal error"),
		})
	case errors.Is(err, app.ErrAccessDenied):
		log.Info("GetWashServer client error", def.LogHTTPStatus, codeForbidden.status, "code", codeForbidden.extra, "err", err)
		return washServer.NewGetWashServerDefault(codeForbidden.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeForbidden.extra),
			Message: swag.String(err.Error()),
		})
	case errors.Is(err, app.ErrNotFound):
		log.Info("GetWashServer client error", def.LogHTTPStatus, codeNotFound.status, "code", codeNotFound.extra, "err", err)
		return washServer.NewGetWashServerDefault(codeNotFound.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeNotFound.extra),
			Message: swag.String(err.Error()),
		})
	case err == nil:
		log.Info("GetWashServer ok", "id", params.ID)
		return washServer.NewGetWashServerOK().WithPayload(dto.WashServerToRest(s))
	}
}

func (svc *service) AddWashServer(params washServer.AddWashServerParams, profile interface{}) middleware.Responder {
	prof := profile.(*firebase_auth.FirebaseProfile)
	wash, err := dto.WashServerFromRestAdd(params.Body)
	if err == nil {
		err = svc.washServerSvc.Add(dto.ToAppIdentityProfile(*prof), *wash)
	}
	switch {
	default:
		log.PrintErr("AddWashServer server error", def.LogHTTPStatus, codeInternal.status, "code", codeInternal.extra, "err", err)
		return washServer.NewAddWashServerDefault(codeInternal.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeInternal.extra),
			Message: swag.String("internal error"),
		})
	case errors.Is(err, app.ErrAccessDenied):
		log.Info("AddWashServer client error", def.LogHTTPStatus, codeForbidden.status, "code", codeForbidden.extra, "err", err)
		return washServer.NewAddWashServerDefault(codeForbidden.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeForbidden.extra),
			Message: swag.String(err.Error()),
		})
	case err == nil:
		log.Info("AddWashServer ok")
		return washServer.NewAddWashServerOK()
	}
}

func (svc *service) EditWashServer(params washServer.EditWashServerParams, profile interface{}) middleware.Responder {
	prof := profile.(*firebase_auth.FirebaseProfile)
	wash, err := dto.WashServerFromRestUpdate(params.Body)
	if err == nil {
		err = svc.washServerSvc.Edit(dto.ToAppIdentityProfile(*prof), params.ID, *wash)
	}
	switch {
	default:
		log.PrintErr("EditWashServer server error", def.LogHTTPStatus, codeInternal.status, "code", codeInternal.extra, "err", err)
		return washServer.NewEditWashServerDefault(codeInternal.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeInternal.extra),
			Message: swag.String("internal error"),
		})
	case errors.Is(err, app.ErrAccessDenied):
		log.Info("EditWashServer client error", def.LogHTTPStatus, codeForbidden.status, "code", codeForbidden.extra, "err", err)
		return washServer.NewEditWashServerDefault(codeForbidden.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeForbidden.extra),
			Message: swag.String(err.Error()),
		})
	case errors.Is(err, app.ErrNotFound):
		log.Info("EditWashServer client error", def.LogHTTPStatus, codeNotFound.status, "code", codeNotFound.extra, "err", err)
		return washServer.NewEditWashServerDefault(codeNotFound.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeNotFound.extra),
			Message: swag.String(err.Error()),
		})
	case err == nil:
		log.Info("EditWashServer ok")
		return washServer.NewEditWashServerOK()
	}
}

func (svc *service) DeleteWashServer(params washServer.DeleteWashServerParams, profile interface{}) middleware.Responder {
	prof := profile.(*firebase_auth.FirebaseProfile)
	err := svc.washServerSvc.Delete(dto.ToAppIdentityProfile(*prof), params.ID)
	switch {
	default:
		log.PrintErr("DeleteWashServer server error", def.LogHTTPStatus, codeInternal.status, "code", codeInternal.extra, "err", err)
		return washServer.NewDeleteWashServerDefault(codeInternal.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeInternal.extra),
			Message: swag.String("internal error"),
		})
	case errors.Is(err, app.ErrAccessDenied):
		log.Info("DeleteWashServer client error", def.LogHTTPStatus, codeForbidden.status, "code", codeForbidden.extra, "err", err)
		return washServer.NewDeleteWashServerDefault(codeForbidden.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeForbidden.extra),
			Message: swag.String(err.Error()),
		})
	case errors.Is(err, app.ErrNotFound):
		log.Info("DeleteWashServer client error", def.LogHTTPStatus, codeNotFound.status, "code", codeNotFound.extra, "err", err)
		return washServer.NewDeleteWashServerDefault(codeNotFound.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeNotFound.extra),
			Message: swag.String(err.Error()),
		})
	case err == nil:
		log.Info("DeleteWashServer ok", "id", params.ID)
		return washServer.NewDeleteWashServerNoContent()
	}
}

func (svc *service) ListWashServer(params washServer.ListWashServerParams, profile interface{}) middleware.Responder {
	prof := profile.(*firebase_auth.FirebaseProfile)
	ss, warnings, err := svc.washServerSvc.List(dto.ToAppIdentityProfile(*prof), dto.ListFilterFromRest(params.Body))
	switch {
	default:
		log.PrintErr("ListWashServer server error", def.LogHTTPStatus, codeInternal.status, "code", codeInternal.extra, "err", err)
		return washServer.NewListWashServerDefault(codeInternal.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeInternal.extra),
			Message: swag.String("internal error"),
		})
	case errors.Is(err, app.ErrAccessDenied):
		log.Info("ListWashServer client error", def.LogHTTPStatus, codeForbidden.status, "code", codeForbidden.extra, "err", err)
		return washServer.NewListWashServerDefault(codeForbidden.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeForbidden.extra),
			Message: swag.String(err.Error()),
		})
	case err == nil:
		log.Info("ListWashServer ok")
		return washServer.NewListWashServerOK().WithPayload(&models.ListWashServer{
			Warnings: warnings,
			Items:    dto.WashServersToRest(ss),
		})
	}
}

func (svc *service) GenerateKeyWashServer(params washServer.GenerateKeyWashServerParams, profile interface{}) middleware.Responder {
	prof := profile.(*firebase_auth.FirebaseProfile)
	key, err := svc.washServerSvc.GenerateServiceKey(dto.ToAppIdentityProfile(*prof), params.ID)
	switch {
	default:
		log.PrintErr("GenerateKeyWashServer server error", def.LogHTTPStatus, codeInternal.status, "code", codeInternal.extra, "err", err)
		return washServer.NewEditWashServerDefault(codeInternal.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeInternal.extra),
			Message: swag.String("internal error"),
		})
	case errors.Is(err, app.ErrAccessDenied):
		log.Info("GenerateKeyWashServer client error", def.LogHTTPStatus, codeForbidden.status, "code", codeForbidden.extra, "err", err)
		return washServer.NewEditWashServerDefault(codeForbidden.status).WithPayload(&models.Error{
			Code:    swag.Int32(codeForbidden.extra),
			Message: swag.String(err.Error()),
		})
	case err == nil:
		log.Info("GenerateKeyWashServer ok")
		return washServer.NewGenerateKeyWashServerOK().WithPayload(&models.WashServerGenerateKeyResp{
			ServiceKey: *key,
		})
	}
}
